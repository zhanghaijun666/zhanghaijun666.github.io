import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as a,e as t,f as p}from"./app-efa5e96e.js";const e={},o=p(`<nav class="table-of-contents"><ul></ul></nav><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> uiautomator2 <span class="token keyword">as</span> u2
<span class="token keyword">import</span> time
<span class="token keyword">import</span> random
<span class="token comment"># d = u2.connect()  # 有线连接，手机需要插电脑上</span>
<span class="token comment">#通过无线连接，电脑和手机需要在同一个局域网内，并且需要先用有线的方式做过初始化</span>
d <span class="token operator">=</span> u2<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">&quot;192.168.0.108&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># d.app_stop(&quot;com.eg.android.AlipayGphone&quot;)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;打开支付宝&quot;</span><span class="token punctuation">)</span>
d<span class="token punctuation">.</span>app_start<span class="token punctuation">(</span><span class="token string">&quot;com.eg.android.AlipayGphone&quot;</span><span class="token punctuation">)</span>
<span class="token comment">## 休眠2s等待支付宝完全启动</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;打开蚂蚁森林，等待5s……&quot;</span><span class="token punctuation">)</span>
d<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">&quot;蚂蚁森林&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">## 我手机比较卡，进入蚂蚁森林后还需要几秒钟才能完全加载完</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">collectEnergy</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;开始第%d次偷能量！&quot;</span> <span class="token operator">%</span> cnt<span class="token punctuation">)</span>

    <span class="token comment"># 开始扫描点击有能力出现的区域</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span><span class="token number">900</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            d<span class="token punctuation">.</span>long_click<span class="token punctuation">(</span>x <span class="token operator">+</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">+</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> cnt <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
                d<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token number">536</span><span class="token punctuation">,</span><span class="token number">1816</span><span class="token punctuation">)</span>

cnt <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    collectEnergy<span class="token punctuation">(</span>cnt<span class="token punctuation">)</span>
    a <span class="token operator">=</span> d<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&quot;//*[@resource-id=&#39;J_tree_dialog_wrap&#39;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bounds
    d<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">80</span><span class="token punctuation">)</span> <span class="token comment"># 找能量按钮的坐标</span>

    <span class="token comment">## 如果页面出现了“返回我的森林”说明已经没有能量可偷了，结束</span>
    <span class="token keyword">if</span> d<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//*[@text=&quot;返回我的森林&quot;]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click_exists<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    cnt <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;###结束###&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># d.app_stop(&quot;com.eg.android.AlipayGphone&quot;) # 退出支付宝</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2);function c(l,u){return s(),a("div",null,[t(" more "),o])}const r=n(e,[["render",c],["__file","21.Python代码实现蚂蚁森林自动偷能量.html.vue"]]);export{r as default};
