<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.63" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://haijunit.top/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html"><meta property="og:site_name" content="å­¦ä¹ ç¬”è®°"><meta property="og:title" content="K8Sæ ¸å¿ƒç»„ä»¶"><meta property="og:description" content="[[toc]] æ–‡æ¡£åœ°å€ kubernetes å®˜ç½‘ (https://kubernetes.io/); æ–‡æ¡£ (https://kubernetes.io/zh/docs/concepts/workloads/controllers/); ä¸­æ–‡æ–‡æ¡£ (http://docs.kubernetes.org.cn/230.html); Deploymen..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-05-23T07:13:54.000Z"><meta property="article:author" content="çŸ¥è¯†åº“"><meta property="article:tag" content="kubernetes"><meta property="article:published_time" content="2023-02-20T16:07:59.000Z"><meta property="article:modified_time" content="2023-05-23T07:13:54.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"K8Sæ ¸å¿ƒç»„ä»¶","image":[""],"datePublished":"2023-02-20T16:07:59.000Z","dateModified":"2023-05-23T07:13:54.000Z","author":[{"@type":"Person","name":"çŸ¥è¯†åº“","url":"https://haijunit.top","email":"zhanghaijun_java@163.com"}]}</script><link rel="shortcut icon" href="/favicon.ico"><link rel="manifest" href="/manifest.json"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;"><meta name="referrer" content="never"><meta name="keywords" content="å¸Œæœ›æ˜¯ç«ï¼Œå¤±æœ›æ˜¯çƒŸï¼Œäººç”Ÿå°±æ˜¯ä¸€è¾¹ç”Ÿç«ä¸€è¾¹å†’çƒŸ"><meta name="theme-color" content="#11a8cd"><link rel="alternate" type="application/atom+xml" href="https://haijunit.top/atom.xml" title="å­¦ä¹ ç¬”è®° Atom Feed"><link rel="alternate" type="application/json" href="https://haijunit.top/feed.json" title="å­¦ä¹ ç¬”è®° JSON Feed"><link rel="alternate" type="application/rss+xml" href="https://haijunit.top/rss.xml" title="å­¦ä¹ ç¬”è®° RSS Feed"><title>K8Sæ ¸å¿ƒç»„ä»¶ | å­¦ä¹ ç¬”è®°</title><meta name="description" content="[[toc]] æ–‡æ¡£åœ°å€ kubernetes å®˜ç½‘ (https://kubernetes.io/); æ–‡æ¡£ (https://kubernetes.io/zh/docs/concepts/workloads/controllers/); ä¸­æ–‡æ–‡æ¡£ (http://docs.kubernetes.org.cn/230.html); Deploymen...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-29a8b438.css" as="style"><link rel="stylesheet" href="/assets/style-29a8b438.css">
    <link rel="modulepreload" href="/assets/app-d6438571.js"><link rel="modulepreload" href="/assets/40.K8Sæ ¸å¿ƒç»„ä»¶.html-56920d6d.js"><link rel="modulepreload" href="/assets/40.K8Sæ ¸å¿ƒç»„ä»¶.html-3ebab64a.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.png" alt="å­¦ä¹ ç¬”è®°"><!----><span class="vp-site-name hide-in-pad">å­¦ä¹ ç¬”è®°</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a class="vp-link nav-link" href="/"><span class="font-icon icon iconfont icon-home" style=""></span>åšå®¢ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a class="vp-link nav-link" href="/blog.html"><span class="font-icon icon iconfont icon-home" style=""></span>é¡¹ç›®ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="ç»“æ„ä¸ç®—æ³•"><span class="title"><span class="font-icon icon iconfont icon-home" style=""></span>ç»“æ„ä¸ç®—æ³•</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="vp-link nav-link" href="/20.%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/10.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="font-icon icon iconfont icon-home" style=""></span>æ•°æ®ç»“æ„<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/20.%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/30.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="font-icon icon iconfont icon-home" style=""></span>è®¾è®¡æ¨¡å¼<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="ç¼–ç¨‹æŠ€å·§"><span class="title"><span class="font-icon icon iconfont icon-home" style=""></span>ç¼–ç¨‹æŠ€å·§</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/05.Windows/"><span class="font-icon icon iconfont icon-home" style=""></span>Windows<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/06.CentOS/"><span class="font-icon icon iconfont icon-home" style=""></span>CentOS<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/09.Shell%E8%84%9A%E6%9C%AC/"><span class="font-icon icon iconfont icon-home" style=""></span>Shellè„šæœ¬<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/09.%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"><span class="font-icon icon iconfont icon-home" style=""></span>ç¼–ç¨‹åŸºç¡€<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/10.HTML/"><span class="font-icon icon iconfont icon-home" style=""></span>HTML<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/11.CSSS/"><span class="font-icon icon iconfont icon-home" style=""></span>CSSS<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/12.JavaScript/"><span class="font-icon icon iconfont icon-home" style=""></span>JavaScript<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/12.TypeScript/"><span class="font-icon icon iconfont icon-home" style=""></span>TypeScript<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/15.VUE%E5%BA%94%E7%94%A8/"><span class="font-icon icon iconfont icon-home" style=""></span>VUEåº”ç”¨<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/20.Java/"><span class="font-icon icon iconfont icon-home" style=""></span>Java<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/30.Python/"><span class="font-icon icon iconfont icon-home" style=""></span>Python<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/40.GoLang/"><span class="font-icon icon iconfont icon-home" style=""></span>GoLang<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/30.ç¼–ç¨‹æŠ€å·§/50.C++/"><span class="font-icon icon iconfont icon-home" style=""></span>C++<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="é¡¹ç›®ç®¡ç†"><span class="title"><span class="font-icon icon iconfont icon-home" style=""></span>é¡¹ç›®ç®¡ç†</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="vp-link nav-link" href="/60.%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/10.%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/"><span class="font-icon icon iconfont icon-home" style=""></span>ä»£ç è§„èŒƒ<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/60.%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/20.%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F/"><span class="font-icon icon iconfont icon-home" style=""></span>ä»£ç è´¨é‡<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/60.%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/60.WEB%E6%B5%8B%E8%AF%95/"><span class="font-icon icon iconfont icon-home" style=""></span>WEBæµ‹è¯•<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="å®¹å™¨æŠ€æœ¯"><span class="title"><span class="font-icon icon iconfont icon-home" style=""></span>å®¹å™¨æŠ€æœ¯</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="vp-link nav-link" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/10.Docker/"><span class="font-icon icon iconfont icon-home" style=""></span>Docker<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/11.DockerSwarm/"><span class="font-icon icon iconfont icon-home" style=""></span>DockerSwarm<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/15.%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93/"><span class="font-icon icon iconfont icon-home" style=""></span>é•œåƒä»“åº“<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/60.kubernetes%E4%BB%8B%E7%BB%8D/"><span class="font-icon icon iconfont icon-home" style=""></span>kubernetesä»‹ç»<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/61.kubernetes%E5%BB%BA%E8%AE%BE/"><span class="font-icon icon iconfont icon-home" style=""></span>kuberneteså»ºè®¾<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link active" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/"><span class="font-icon icon iconfont icon-home" style=""></span>kuberneteså®æˆ˜<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="é›†æˆé…ç½®"><span class="title"><span class="font-icon icon iconfont icon-home" style=""></span>é›†æˆé…ç½®</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="vp-link nav-link" href="/62.%E9%9B%86%E6%88%90%E9%85%8D%E7%BD%AE/09.%E9%9B%86%E6%88%90%E6%9E%84%E5%BB%BA/"><span class="font-icon icon iconfont icon-home" style=""></span>é›†æˆæ„å»º<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/62.%E9%9B%86%E6%88%90%E9%85%8D%E7%BD%AE/10.SpringBoot/"><span class="font-icon icon iconfont icon-home" style=""></span>SpringBoot<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/62.%E9%9B%86%E6%88%90%E9%85%8D%E7%BD%AE/11.MyBatis/"><span class="font-icon icon iconfont icon-home" style=""></span>MyBatis<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/62.%E9%9B%86%E6%88%90%E9%85%8D%E7%BD%AE/20.%E7%BC%93%E5%AD%98Reids/"><span class="font-icon icon iconfont icon-home" style=""></span>ç¼“å­˜Reids<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/62.%E9%9B%86%E6%88%90%E9%85%8D%E7%BD%AE/21.%E4%B8%AD%E9%97%B4%E4%BB%B6MQ/"><span class="font-icon icon iconfont icon-home" style=""></span>ä¸­é—´ä»¶MQ<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/62.%E9%9B%86%E6%88%90%E9%85%8D%E7%BD%AE/31.Nginx/"><span class="font-icon icon iconfont icon-home" style=""></span>Nginx<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/62.%E9%9B%86%E6%88%90%E9%85%8D%E7%BD%AE/40.Elasticsearch/"><span class="font-icon icon iconfont icon-home" style=""></span>Elasticsearch<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/62.%E9%9B%86%E6%88%90%E9%85%8D%E7%BD%AE/50.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"><span class="font-icon icon iconfont icon-home" style=""></span>æ–‡ä»¶ç³»ç»Ÿ<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="è¿ç»´æŠ€å·§"><span class="title"><span class="font-icon icon iconfont icon-home" style=""></span>è¿ç»´æŠ€å·§</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="vp-link nav-link" href="/80.%E8%BF%90%E7%BB%B4%E6%8A%80%E5%B7%A7/10.%E8%BF%90%E7%BB%B4%E5%B7%A5%E5%85%B7/"><span class="font-icon icon iconfont icon-home" style=""></span>è¿ç»´å·¥å…·<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/80.%E8%BF%90%E7%BB%B4%E6%8A%80%E5%B7%A7/20.%E5%BC%80%E5%8F%91%E6%90%AD%E5%BB%BA/"><span class="font-icon icon iconfont icon-home" style=""></span>å¼€å‘æ­å»º<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/80.%E8%BF%90%E7%BB%B4%E6%8A%80%E5%B7%A7/21.%E8%AF%81%E4%B9%A6%E8%AE%A4%E8%AF%81/"><span class="font-icon icon iconfont icon-home" style=""></span>è¯ä¹¦è®¤è¯<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/80.%E8%BF%90%E7%BB%B4%E6%8A%80%E5%B7%A7/30.%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86/"><span class="font-icon icon iconfont icon-home" style=""></span>æœåŠ¡ç®¡ç†<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="æ•°æ®åº“"><span class="title"><span class="font-icon icon iconfont icon-home" style=""></span>æ•°æ®åº“</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="vp-link nav-link" href="/81.%E6%95%B0%E6%8D%AE%E5%BA%93/10.SQL/"><span class="font-icon icon iconfont icon-home" style=""></span>SQL<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/81.%E6%95%B0%E6%8D%AE%E5%BA%93/20.MySQL/"><span class="font-icon icon iconfont icon-home" style=""></span>MySQL<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/81.%E6%95%B0%E6%8D%AE%E5%BA%93/21.%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="font-icon icon iconfont icon-home" style=""></span>è¾¾æ¢¦æ•°æ®åº“<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/81.%E6%95%B0%E6%8D%AE%E5%BA%93/22.InfluxDB/"><span class="font-icon icon iconfont icon-home" style=""></span>InfluxDB<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="ç´¢å¼•"><span class="title"><span class="font-icon icon iconfont icon-jiansuo" style=""></span>ç´¢å¼•</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="vp-link nav-link" href="/article.html"><span class="font-icon icon iconfont icon-list" style=""></span>å…¨éƒ¨<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/category.html"><span class="font-icon icon iconfont icon-category" style=""></span>åˆ†ç±»<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/star.html"><span class="font-icon icon iconfont icon-star" style=""></span>æ”¶è—<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/tag.html"><span class="font-icon icon iconfont icon-tag" style=""></span>æ ‡ç­¾<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/timeline.html"><span class="font-icon icon iconfont icon-time" style=""></span>æ—¶é—´è½´<!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">æœç´¢</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Docker</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">DockerSwarm</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">é•œåƒä»“åº“</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">kubernetesä»‹ç»</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">kuberneteså»ºè®¾</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><!----><span class="vp-sidebar-title">kuberneteså®æˆ˜</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/09.Kubernets%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7.html"><!---->Kubernetsä½¿ç”¨å·¥å…·<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/10.SpringBoot%E9%9B%B6%E5%AE%95%E6%9C%BA%E5%8F%91%E5%B8%83.html"><!---->SpringBooté›¶å®•æœºå‘å¸ƒ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/15.Argo%20CD.html"><!---->Argo CD<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/20.Helm%E5%AE%89%E8%A3%85Redis.html"><!---->Helmå®‰è£…Redis<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/21.Helm%E5%AE%89%E8%A3%85Mysql.html"><!---->Helmå®‰è£…Mysql<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/22.Helm%E5%AE%89%E8%A3%85RabbitMQ.html"><!---->Helmå®‰è£…RabbitMQ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/23.Helm%E5%AE%89%E8%A3%85MinIO.html"><!---->Helmå®‰è£…MinIO<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/30.MySQL%E4%B8%BB%E4%BB%8E.html"><!---->MySQLä¸»ä»<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html"><!---->K8Sæ ¸å¿ƒç»„ä»¶<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#æ–‡æ¡£åœ°å€"><!---->æ–‡æ¡£åœ°å€<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#deployment"><!---->Deployment<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#replicaset"><!---->Replicaset<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#daemonset"><!---->DaemonSet<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#job"><!---->Job<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#cronjob"><!---->cronJob<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#kubernetes-é›†ç¾¤"><!---->kubernetes é›†ç¾¤<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#kubernetes-æ ¸å¿ƒç»„ä»¶"><!---->kubernetes æ ¸å¿ƒç»„ä»¶<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#æœåŠ¡å‘ç°"><!---->æœåŠ¡å‘ç°<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#ingress-7-å±‚-åº”ç”¨å±‚-è´Ÿè½½å‡è¡¡"><!---->Ingress (7 å±‚[åº”ç”¨å±‚]è´Ÿè½½å‡è¡¡)<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/50.K8S%E5%AE%9E%E6%88%98.html"><!---->K8Så®æˆ˜<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/60.K8S%E9%83%A8%E7%BD%B2%E5%AE%9E%E6%88%98.html"><!---->K8Séƒ¨ç½²å®æˆ˜<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/61.kubernets%E5%BA%94%E7%94%A8.html"><!---->kubernetsåº”ç”¨<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->K8Sæ ¸å¿ƒç»„ä»¶</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://haijunit.top" target="_blank" rel="noopener noreferrer">çŸ¥è¯†åº“</a></span><span property="author" content="çŸ¥è¯†åº“"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-02-20T16:07:59.000Z"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category4 clickable" role="navigation">å®¹å™¨æŠ€æœ¯</span><span class="page-category-item category8 clickable" role="navigation">kuberneteså®æˆ˜</span><!--]--><meta property="articleSection" content="å®¹å™¨æŠ€æœ¯,kuberneteså®æˆ˜"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag6 clickable" role="navigation">kubernetes</span><!--]--><meta property="keywords" content="kubernetes"></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 12 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT12M"></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#æ–‡æ¡£åœ°å€">æ–‡æ¡£åœ°å€</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#deployment">Deployment</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#replicaset">Replicaset</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#daemonset">DaemonSet</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#job">Job</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#cronjob">cronJob</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#kubernetes-é›†ç¾¤">kubernetes é›†ç¾¤</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#kubernetes-æ ¸å¿ƒç»„ä»¶">kubernetes æ ¸å¿ƒç»„ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#æœåŠ¡å‘ç°">æœåŠ¡å‘ç°</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#ingress-7-å±‚-åº”ç”¨å±‚-è´Ÿè½½å‡è¡¡">Ingress (7 å±‚[åº”ç”¨å±‚]è´Ÿè½½å‡è¡¡)</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><!-- more --><nav class="table-of-contents"><ul><li><a aria-current="page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#æ–‡æ¡£åœ°å€" class="router-link-active router-link-exact-active">æ–‡æ¡£åœ°å€</a></li><li><a aria-current="page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#deployment" class="router-link-active router-link-exact-active">Deployment</a></li><li><a aria-current="page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#replicaset" class="router-link-active router-link-exact-active">Replicaset</a></li><li><a aria-current="page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#daemonset" class="router-link-active router-link-exact-active">DaemonSet</a></li><li><a aria-current="page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#job" class="router-link-active router-link-exact-active">Job</a></li><li><a aria-current="page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#cronjob" class="router-link-active router-link-exact-active">cronJob</a></li><li><a aria-current="page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#kubernetes-é›†ç¾¤" class="router-link-active router-link-exact-active">kubernetes é›†ç¾¤</a></li><li><a aria-current="page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#kubernetes-æ ¸å¿ƒç»„ä»¶" class="router-link-active router-link-exact-active">kubernetes æ ¸å¿ƒç»„ä»¶</a></li><li><a aria-current="page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#æœåŠ¡å‘ç°" class="router-link-active router-link-exact-active">æœåŠ¡å‘ç°</a></li><li><a aria-current="page" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/40.K8S%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html#ingress-7-å±‚-åº”ç”¨å±‚-è´Ÿè½½å‡è¡¡" class="router-link-active router-link-exact-active">Ingress (7 å±‚[åº”ç”¨å±‚]è´Ÿè½½å‡è¡¡)</a></li></ul></nav><h2 id="æ–‡æ¡£åœ°å€" tabindex="-1"><a class="header-anchor" href="#æ–‡æ¡£åœ°å€" aria-hidden="true">#</a> æ–‡æ¡£åœ°å€</h2><ul><li><a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer">kubernetes å®˜ç½‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://kubernetes.io/zh/docs/concepts/workloads/controllers/" target="_blank" rel="noopener noreferrer">æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://docs.kubernetes.org.cn/230.html" target="_blank" rel="noopener noreferrer">ä¸­æ–‡æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="deployment" tabindex="-1"><a class="header-anchor" href="#deployment" aria-hidden="true">#</a> Deployment</h2><blockquote><p>ä¸€ä¸ª Deployment ä¸º Pods å’Œ ReplicaSets æä¾›å£°æ˜å¼çš„æ›´æ–°èƒ½åŠ›ã€‚</p><details class="hint-container details"><summary>nginx-deployment.yaml</summary></details></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: nginx
spec:
  replicas: <span class="token number">3</span>
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.14.2
        ports:
        - containerPort: <span class="token number">80</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>:::</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>kubectl apply <span class="token parameter variable">-f</span> https://k8s.io/examples/controllers/nginx-deployment.yaml
<span class="token comment"># æŸ¥çœ‹ Deployment ä¸Šçº¿çŠ¶æ€</span>
kubectl rollout status deployment/nginx-deployment
kubectl get deployments
kubectl get rs
kubectl get pods --show-labels

<span class="token comment"># æ›´æ–° Deployment</span>
kubectl <span class="token builtin class-name">set</span> image deployment/nginx-deployment <span class="token assign-left variable">nginx</span><span class="token operator">=</span>nginx:1.16.1 <span class="token parameter variable">--record</span>
kubectl describe deployments

<span class="token comment"># æ£€æŸ¥ Deployment ä¿®è®¢å†å²ï¼š</span>
kubectl rollout <span class="token function">history</span> deployment.v1.apps/nginx-deployment
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="replicaset" tabindex="-1"><a class="header-anchor" href="#replicaset" aria-hidden="true">#</a> Replicaset</h2><p>ç¡®ä¿å®¹å™¨åº”ç”¨çš„å‰¯æœ¬æ•°å§‹ç»ˆä¿æŒåœ¨ç”¨æˆ·å®šä¹‰çš„å‰¯æœ¬æ•°,å³å¦‚æœæœ‰å®¹å™¨å¼‚å¸¸é€€å‡º,ä¼šè‡ªåŠ¨åˆ›å»ºæ–°çš„ Pod æ¥æ›¿ä»£;è€Œå¦‚æœå¼‚å¸¸å¤šå‡ºæ¥çš„å®¹å™¨ä¹Ÿä¼šè‡ªåŠ¨å›æ”¶;</p><details class="hint-container details"><summary>replicaset.yaml</summary><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>apiVersion: extensions/v1beta1
kind: ReplicaSet
metadata:
  name: frontend
spec:
  replicas: <span class="token number">3</span>
  selector:
    matchLabels:
      tier: frontend
  template:
    metadata:
      labels:
        tier: frontend
    spec:
      containers:
        - name: Java-nginx
          image: hub.kaikeba.com/library/myapp:v1
          env:
            - name: GET_HOSTS_FROM
              value: dns
          ports:
            - containerPort: <span class="token number">80</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="daemonset" tabindex="-1"><a class="header-anchor" href="#daemonset" aria-hidden="true">#</a> DaemonSet</h2><p>ç¡®ä¿åªè¿è¡Œä¸€ä¸ªå‰¯æœ¬ï¼Œè¿è¡Œåœ¨é›†ç¾¤ä¸­æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚ï¼ˆä¹Ÿå¯ä»¥éƒ¨åˆ†èŠ‚ç‚¹ä¸Šåªè¿è¡Œä¸€ä¸ªä¸”åªæœ‰ä¸€ä¸ª pod å‰¯æœ¬ï¼Œå¦‚ç›‘æ§ ssd ç¡¬ç›˜ï¼‰</p><details class="hint-container details"><summary>my-deamon.yaml</summary><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: my-deamon
  namespace: default
  labels:
    app: daemonset
spec:
  selector:
    matchLabels:
      app: my-daemonset
  template:
    metadata:
      labels:
        app: my-daemonset
    spec:
      containers:
      - name: daemon-app
        image: hub.kaikeba.com/library/myapp:v1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="job" tabindex="-1"><a class="header-anchor" href="#job" aria-hidden="true">#</a> Job</h2><p><code>Job</code>è´Ÿè´£å¤„ç†ä»»åŠ¡ï¼Œå³ä»…æ‰§è¡Œä¸€æ¬¡çš„ä»»åŠ¡ï¼Œå®ƒä¿è¯æ‰¹å¤„ç†ä»»åŠ¡çš„ä¸€ä¸ªæˆ–å¤šä¸ª<code>Pod</code>æˆåŠŸç»“æŸã€‚è€Œ<code>CronJob</code>åˆ™å°±æ˜¯åœ¨<code>Job</code>ä¸ŠåŠ ä¸Šäº†æ—¶é—´è°ƒåº¦ã€‚</p><details class="hint-container details"><summary>job-demo.yaml</summary><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># æˆ‘ä»¬ç”¨Jobè¿™ä¸ªèµ„æºå¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªä»»åŠ¡ï¼Œæˆ‘ä»¬å®šä¸€ä¸ªJobæ¥æ‰§è¡Œä¸€ä¸ªå€’è®¡æ—¶çš„ä»»åŠ¡ï¼Œå®šä¹‰YAMLæ–‡ä»¶ï¼š</span>
apiVersion: batch/v1
kind: Job
metadata:
  name: job-demo
spec:
  template:
    metadata:
      name: job-demo
    spec:
      restartPolicy: Never
      containers:
      - name: counter
        image: busybox
        command:
        - <span class="token string">&quot;bin/sh&quot;</span>
        - <span class="token string">&quot;-c&quot;</span>
        - <span class="token string">&quot;for i in 9 8 7 6 5 4 3 2 1; do echo <span class="token variable">$i</span>; done&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># åˆ›å»º</span>
kubectl apply <span class="token parameter variable">-f</span> job-demo.yaml
<span class="token comment"># æŸ¥è¯¢æ—¥å¿—</span>
kubectl logs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="cronjob" tabindex="-1"><a class="header-anchor" href="#cronjob" aria-hidden="true">#</a> cronJob</h2><p><code>CronJob</code>å…¶å®å°±æ˜¯åœ¨<code>Job</code>çš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†æ—¶é—´è°ƒåº¦ï¼Œæˆ‘ä»¬å¯ä»¥ï¼šåœ¨ç»™å®šçš„æ—¶é—´ç‚¹è¿è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥å‘¨æœŸæ€§åœ°åœ¨ç»™å®šæ—¶é—´ç‚¹è¿è¡Œã€‚è¿™ä¸ªå®é™…ä¸Šå’Œæˆ‘ä»¬<code>Linux</code>ä¸­çš„<code>crontab</code>å°±éå¸¸ç±»ä¼¼äº†ã€‚</p><details class="hint-container details"><summary>cronjob-demo.yaml</summary><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ç°åœ¨ï¼Œæˆ‘ä»¬ç”¨CronJobæ¥ç®¡ç†æˆ‘ä»¬ä¸Šé¢çš„Jobä»»åŠ¡</span>
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: cronjob-demo
spec:
  schedule: <span class="token string">&quot;*/1 * * * *&quot;</span>
  jobTemplate:
    spec:
      template:
        spec:
          restartPolicy: OnFailure
          containers:
          - name: hello
            image: busybox
            args:
            - <span class="token string">&quot;bin/sh&quot;</span>
            - <span class="token string">&quot;-c&quot;</span>
            - <span class="token string">&quot;for i in 9 8 7 6 5 4 3 2 1; do echo <span class="token variable">$i</span>; done&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># åˆ›å»ºcronjob</span>
kubctl apply <span class="token parameter variable">-f</span> cronjob-demo.yaml
<span class="token comment"># æŸ¥è¯¢cronjob</span>
kubectl get cronjob
<span class="token comment"># æŸ¥è¯¢jon ,cronjonä¼šå¾ªç¯å¤šä¸ªjob</span>
kubectl get job
<span class="token comment"># å®æ—¶ç›‘æ§æŸ¥è¯¢job</span>
kubectl get job <span class="token parameter variable">-w</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="kubernetes-é›†ç¾¤" tabindex="-1"><a class="header-anchor" href="#kubernetes-é›†ç¾¤" aria-hidden="true">#</a> kubernetes é›†ç¾¤</h2><h4 id="master-èŠ‚ç‚¹" tabindex="-1"><a class="header-anchor" href="#master-èŠ‚ç‚¹" aria-hidden="true">#</a> master èŠ‚ç‚¹</h4><ul><li>api serverï¼ˆKubernetes API Serverï¼‰<br><br> Kubernetes APIï¼Œé›†ç¾¤çš„ç»Ÿä¸€å…¥å£ï¼Œå„ç»„ä»¶åè°ƒè€…ï¼Œä»¥ HTTP API æä¾›æ¥å£æœåŠ¡ï¼Œæ‰€æœ‰å¯¹è±¡èµ„æºçš„å¢åˆ æ”¹æŸ¥å’Œç›‘å¬æ“ä½œéƒ½ äº¤ç»™ APIServer å¤„ç†åå†æäº¤ç»™ Etcd å­˜å‚¨ã€‚</li><li>etcd<br><br> æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ã€å¯é çš„ key-value å­˜å‚¨ç³»ç»Ÿï¼Œå®ƒç”¨äºå­˜å‚¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å…³é”®æ•°æ®ï¼Œè¿™ä¸ªå®šä¹‰éå¸¸é‡è¦ã€‚<br><br> æ•´ä¸ª kubernetes ç³»ç»Ÿä¸­ä¸€å…±æœ‰ä¸¤ä¸ªæœåŠ¡éœ€è¦ç”¨åˆ° etcd ç”¨æ¥ååŒå’Œå­˜å‚¨é…ç½®ï¼Œåˆ†åˆ«æ˜¯ï¼š<br><br> 1ï¼‰ç½‘ç»œæ’ä»¶ flannelã€å¯¹äºå…¶å®ƒç½‘ç»œæ’ä»¶ä¹Ÿéœ€è¦ç”¨åˆ° etcd å­˜å‚¨ç½‘ç»œçš„é…ç½®ä¿¡æ¯<br><br> 2ï¼‰kubernetes æœ¬èº«ï¼ŒåŒ…æ‹¬å„ç§å¯¹è±¡çš„çŠ¶æ€å’Œå…ƒä¿¡æ¯é…ç½®<br></li><li>scheduler<br> é€šè¿‡è°ƒåº¦ç®—æ³•ä¸ºå¾…è°ƒåº¦ Pod åˆ—è¡¨ä¸Šçš„æ¯ä¸€ä¸ª Pod ä» Node åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªæœ€åˆé€‚çš„ Nodeã€‚</li></ul><h4 id="node-èŠ‚ç‚¹" tabindex="-1"><a class="header-anchor" href="#node-èŠ‚ç‚¹" aria-hidden="true">#</a> node èŠ‚ç‚¹</h4><ul><li>Docker<br><br> å®¹å™¨å¼•æ“ï¼ˆç¨‹åºï¼‰ï¼Œk8s ç®¡ç†å®¹å™¨ï¼Œå®¹å™¨ç”± docker è¿›è¡Œåˆ›å»ºï¼Œk8s åº•å±‚å¿…é¡»æœ‰ docker å¼•æ“ã€‚<br></li><li>pod<br><br> Pod æ˜¯æœ€å°éƒ¨ç½²å•å…ƒï¼Œä¸€ä¸ª Pod æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ç»„æˆï¼ŒPod ä¸­å®¹å™¨å…±äº«å­˜å‚¨å’Œç½‘ç»œï¼Œåœ¨åŒä¸€å° Docker ä¸»æœºä¸Šè¿è¡Œ</li><li>kubelet<br><br> ç›‘å¬ etcd,è·å–æŒ‡ä»¤ç®¡ç† pod,kubelet æ˜¯çœŸæ­£ç®¡ç† pod çš„ç»„ä»¶ã€‚<br><br> kubelet é»˜è®¤ç›‘å¬å››ä¸ªç«¯å£ï¼Œåˆ†åˆ«ä¸º 10250 ã€10255ã€10248ã€4194<br><ul><li>10250ï¼ˆkubelet APIï¼‰ï¼š<br><br> kubelet server ä¸ apiserver é€šä¿¡çš„ç«¯å£ï¼Œå®šæœŸè¯·æ±‚ apiserver è·å–è‡ªå·±æ‰€åº”å½“å¤„ç†çš„ä»»åŠ¡ï¼Œé€šè¿‡è¯¥ç«¯å£å¯ä»¥è®¿é—®è·å– node èµ„æºä»¥åŠçŠ¶æ€ã€‚</li><li>10248ï¼ˆå¥åº·æ£€æŸ¥ç«¯å£ï¼‰ï¼š<br><br> é€šè¿‡è®¿é—®è¯¥ç«¯å£å¯ä»¥åˆ¤æ–­ kubelet æ˜¯å¦æ­£å¸¸å·¥ä½œ, é€šè¿‡ kubelet çš„å¯åŠ¨å‚æ•° --healthz-port å’Œ --healthz-bind-address æ¥æŒ‡å®šç›‘å¬çš„åœ°å€å’Œç«¯å£ã€‚</li><li>4194ï¼ˆcAdvisor ç›‘å¬ï¼‰ï¼š<br><br> kublet é€šè¿‡è¯¥ç«¯å£å¯ä»¥è·å–åˆ°è¯¥èŠ‚ç‚¹çš„ç¯å¢ƒä¿¡æ¯ä»¥åŠ node ä¸Šè¿è¡Œçš„å®¹å™¨çŠ¶æ€ç­‰å†…å®¹ï¼Œè®¿é—® <a href="http://localhost:4194" target="_blank" rel="noopener noreferrer">http://localhost:4194<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> å¯ä»¥çœ‹åˆ° cAdvisor çš„ç®¡ç†ç•Œé¢,é€šè¿‡ kubelet çš„å¯åŠ¨å‚æ•° <code>--cadvisor-port</code> å¯ä»¥æŒ‡å®šå¯åŠ¨çš„ç«¯å£ã€‚</li><li>10255 ï¼ˆreadonly APIï¼‰ï¼š<br><br> æä¾›äº† pod å’Œ node çš„ä¿¡æ¯ï¼Œæ¥å£ä»¥åªè¯»å½¢å¼æš´éœ²å‡ºå»ï¼Œè®¿é—®è¯¥ç«¯å£ä¸éœ€è¦è®¤è¯å’Œé‰´æƒã€‚</li></ul></li><li>kube-proxy<br><br> ä»£ç†æœåŠ¡ï¼Œä¸»è¦ç”¨æ¥åšè´Ÿè½½å‡è¡¡ã€‚è®¾ç½® iptables è´Ÿè½½è§„åˆ™ï¼Œç»´æŠ¤ç½‘ç»œè§„åˆ™å’Œå››å±‚è´Ÿè½½å‡è¡¡å·¥ä½œ</li><li>fluentd <br>æ—¥å¿—æ”¶é›†ç»„ä»¶</li><li>dns <br>åŸŸåè§£ææœåŠ¡å™¨</li></ul><h4 id="å…¶ä»–ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#å…¶ä»–ç»„ä»¶" aria-hidden="true">#</a> å…¶ä»–ç»„ä»¶</h4><ul><li>CoreDNSï¼šå¯ä»¥ä¸ºé›†ç¾¤ä¸­çš„ SVC åˆ›å»ºä¸€ä¸ªåŸŸå IP çš„å¯¹åº”å…³ç³»è§£æ</li><li>DasHBoardï¼šç»™ K8s é›†ç¾¤æä¾›ä¸€ä¸ª B/S ç»“æ„è®¿é—®ä½“ç³»</li><li>Ingress Controllerï¼šå®˜æ–¹åªèƒ½å®ç°å››å±‚ä»£ç†ï¼ŒINGRESS å¯ä»¥å®ç°ä¸ƒå±‚ä»£ç†</li><li>Federationï¼šæä¾›ä¸€ä¸ªå¯ä»¥è·¨é›†ç¾¤ä¸­å¿ƒå¤š K8S ç»Ÿä¸€ç®¡ç†åŠŸèƒ½</li><li>Prometheusï¼šæä¾› K8S é›†ç¾¤çš„ç›‘æ§èƒ½åŠ›</li><li>ELKï¼šæä¾› K8s é›†ç¾¤æ—¥å¿—ç»Ÿä¸€åˆ†æä»‹å…¥å¹³å°</li></ul><h2 id="kubernetes-æ ¸å¿ƒç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#kubernetes-æ ¸å¿ƒç»„ä»¶" aria-hidden="true">#</a> kubernetes æ ¸å¿ƒç»„ä»¶</h2><h4 id="rc-æ§åˆ¶å™¨-replicationcontroller" tabindex="-1"><a class="header-anchor" href="#rc-æ§åˆ¶å™¨-replicationcontroller" aria-hidden="true">#</a> RC ï¼ˆæ§åˆ¶å™¨ ReplicationControllerï¼‰</h4><p>ç”¨æ¥ç¡®ä¿å®¹å™¨åº”ç”¨çš„å‰¯æœ¬æ•°å§‹ç»ˆä¿æŒåœ¨ç”¨æˆ·å®šä¹‰çš„å‰¯æœ¬æ•°ï¼Œå³å¦‚æœæœ‰å®¹å™¨å¼‚å¸¸é€€å‡ºï¼Œä¼šè‡ªåŠ¨åˆ›å»ºæ–°çš„ Pod æ¥æ›¿ä»£ï¼Œè€Œå¦‚æœå¼‚å¸¸å¤šå‡ºçš„å®¹å™¨ä¹Ÿä¼šè‡ªåŠ¨å›æ”¶ã€‚<br><br> åœ¨æ–°ç‰ˆæœ¬çš„ Kubernetes ä¸­å»ºè®®ä½¿ç”¨ ReplicaSet æ¥å–ä»£ ReplicationController</p><h4 id="rs-æ§åˆ¶å™¨-replicase" tabindex="-1"><a class="header-anchor" href="#rs-æ§åˆ¶å™¨-replicase" aria-hidden="true">#</a> RS ï¼ˆæ§åˆ¶å™¨ ReplicaSeï¼‰</h4><p>ReplicaSet è·Ÿ ReplicationController æ²¡æœ‰æœ¬è´¨çš„ä¸åŒï¼Œåªæ˜¯åå­—ä¸ä¸€æ ·ï¼Œå¹¶ä¸” ReplicaSet æ”¯æŒé›†åˆå¼çš„ selector<br><br> è™½ç„¶ ReplicaSet å¯ä»¥ç‹¬ç«‹ä½¿ç”¨ï¼Œä½†ä¸€èˆ¬è¿˜æ˜¯å»ºè®®ä½¿ç”¨ Deployment æ¥è‡ªåŠ¨ç®¡ç† ReplicaSet,è¿™æ ·å°±æ— éœ€æ‹…å¿ƒè·Ÿå…¶ä»–æœºåˆ¶çš„ä¸å…¼å®¹é—®é¢˜ï¼ˆæ¯”å¦‚ ReplicaSet ä¸æ”¯æŒ rolling-update ä½† Deployment æ”¯æŒï¼‰<br></p><h4 id="deployment-1" tabindex="-1"><a class="header-anchor" href="#deployment-1" aria-hidden="true">#</a> Deployment</h4><p>ä¸º Pod å’Œ ReplicaSet æä¾›äº†ä¸€ä¸ª å£°æ˜å¼å®šä¹‰æ–¹æ³•ï¼Œç”¨æ¥æ›¿ä»£ä»¥å‰çš„ ReplicationController æ¥æ–¹ä¾¿çš„ç®¡ç†åº”ç”¨ã€‚<br><br> å…¸å‹çš„åº”ç”¨åœºæ™¯ï¼š<br><br> â€‹ ï¼ˆ1ï¼‰ã€å®šä¹‰ Deployment æ¥åˆ›å»º Pod å’Œ ReplicaSet<br><br> â€‹ ï¼ˆ2ï¼‰ã€æ»šåŠ¨å‡çº§å’Œå›æ»šåº”ç”¨<br><br> â€‹ ï¼ˆ3ï¼‰ã€æ‰©å®¹å’Œç´¢å®¹<br><br> â€‹ ï¼ˆ4ï¼‰ã€æš‚åœå’Œç»§ç»­ Deployment<br><br> Deployment ä¸ä»…ä»…å¯ä»¥æ»šåŠ¨æ›´æ–°ï¼Œè€Œä¸”å¯ä»¥è¿›è¡Œå›æ»šï¼Œå¦‚æœå‘ç°å‡çº§åˆ° V2 ç‰ˆæœ¬åï¼Œå‘ç°æœåŠ¡ä¸å¯ç”¨ï¼Œå¯ä»¥å›æ»šåˆ° V1 ç‰ˆæœ¬ã€‚<br></p><ul><li>HPA ï¼ˆHorizontalPodAutoScaleï¼‰<br><br> Horizontal Pod Autoscaling ä»…é€‚ç”¨äº Deployment å’Œ ReplicaSet,åœ¨ V1 ç‰ˆæœ¬ä¸­ä»…æ”¯æŒæ ¹æ® Pod çš„ CPU åˆ©ç”¨ç‡æ‰©å®¹ï¼Œåœ¨ vlalpha ç‰ˆæœ¬ä¸­ï¼Œæ”¯æŒæ ¹æ®å†…å­˜å’Œç”¨æˆ·è‡ªå®šä¹‰çš„ metric æ‰©ç¼©å®¹</li></ul><h4 id="statefullset" tabindex="-1"><a class="header-anchor" href="#statefullset" aria-hidden="true">#</a> StatefullSet</h4><p>StatefullSet æ˜¯ä¸ºäº†è§£å†³æœ‰çŠ¶æ€æœåŠ¡çš„é—®é¢˜ï¼ˆå¯¹åº” Deployments å’Œ ReplicaSets æ˜¯ä¸ºæ— çŠ¶æ€æœåŠ¡è€Œè®¾è®¡ï¼‰ï¼Œå…¶åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼š<br><br> ï¼ˆ1ï¼‰ ç¨³å®šçš„æŒä¹…åŒ–å­˜å‚¨ï¼Œå³ Pod é‡æ–°è°ƒåº¦åè¿˜æ˜¯èƒ½è®¿é—®çš„ç›¸åŒæŒä¹…åŒ–æ•°æ®ï¼ŒåŸºäº PVC æ¥å®ç°<br><br> ï¼ˆ2ï¼‰ç¨³å®šçš„ç½‘ç»œæ ‡å¿—ï¼ŒåŠ Pod é‡æ–°è°ƒåº¦åå…¶ PodName å’Œ HostName ä¸å˜ï¼ŒåŸºäº Headlesss Serviceï¼ˆå³æ²¡æœ‰ Cluster IP çš„ Serviceï¼‰æ¥å®ç°ã€‚<br><br> ï¼ˆ3ï¼‰æœ‰åºéƒ¨ç½²ï¼Œæœ‰åºæ‰©å±•ï¼Œå³ Pod æ˜¯æœ‰é¡ºåºçš„ï¼Œåœ¨éƒ¨ç½²æˆ–è€…æ‰©å±•çš„æ—¶å€™è¦ä¾æ®å®šä¹‰çš„é¡ºåºä¾æ¬¡è¿›è¡Œï¼ˆå³ä» 0 åˆ° N-1,åœ¨ä¸‹ä¸€ä¸ª Pod è¿è¡Œä¹‹å‰æ‰€æœ‰ä¹‹å‰çš„ Pod å¿…é¡»éƒ½æ˜¯ Running å’Œ Ready çŠ¶æ€ï¼‰ï¼ŒåŸºäº init containers æ¥å®ç°ã€‚<br><br> ï¼ˆ4ï¼‰æœ‰åºæ”¶ç¼©ï¼Œæœ‰åºåˆ é™¤ï¼ˆå³ä» N-1 åˆ° 0ï¼‰<br></p><h4 id="daemonset-1" tabindex="-1"><a class="header-anchor" href="#daemonset-1" aria-hidden="true">#</a> DaemonSet</h4><p>DaemonSet ç¡®ä¿å…¨éƒ¨ï¼ˆæˆ–è€…ä¸€äº› [ node æ‰“ä¸Šæ±¡ç‚¹ï¼ˆå¯ä»¥æƒ³è±¡æˆä¸€ä¸ªæ ‡ç­¾ï¼‰,pod å¦‚æœä¸å®šä¹‰å®¹å¿è¿™ä¸ªæ±¡ç‚¹ï¼Œé‚£ä¹ˆ pod å°±ä¸ä¼šè¢«è°ƒåº¦å™¨åˆ†é…åˆ°è¿™ä¸ª node ]ï¼‰<br><br> Node ä¸Šè¿è¡Œä¸€ä¸ª Pod çš„å‰¯æœ¬ã€‚å½“æœ‰ Node åŠ å…¥é›†ç¾¤æ—¶ï¼Œä¹Ÿä¼šä¸ºä»–ä»¬æ–°å¢ä¸€ä¸ª Podã€‚å½“æœ‰ Node ä»é›†ç¾¤ç§»é™¤æ—¶ï¼Œè¿™äº› Pod ä¹Ÿä¼šè¢«å›æ”¶ã€‚åˆ é™¤ DaemonSet å°†ä¼šåˆ é™¤ä»–åˆ›å»ºçš„æ‰€æœ‰ Pod,ä½¿ç”¨ DaemonSet çš„ä¸€äº›å…¸å‹ç”¨æ³•ï¼š<br><br> ï¼ˆ1ï¼‰ è¿è¡Œé›†ç¾¤å­˜å‚¨ daemon,ä¾‹å¦‚åœ¨æ¯ä¸ª Node ä¸Šè¿è¡Œ glustered,ceph<br><br> ï¼ˆ2ï¼‰åœ¨æ¯ä¸ª Node ä¸Šè¿è¡Œæ—¥å¿—æ”¶é›† Daemon,ä¾‹å¦‚ï¼šfluentdã€logstash.<br><br> ï¼ˆ3ï¼‰åœ¨æ¯ä¸ª Node ä¸Šè¿è¡Œç›‘æ§ Daemon,ä¾‹å¦‚ï¼šPrometheus Node Exporter<br></p><h4 id="job-1" tabindex="-1"><a class="header-anchor" href="#job-1" aria-hidden="true">#</a> Job</h4><p>è´Ÿè´£æ‰¹å¤„ç†ä»»åŠ¡ï¼Œå³ä»…æ‰§è¡Œä¸€æ¬¡çš„ä»»åŠ¡ï¼Œå®ƒä¿è¯æ‰¹å¤„ç†ä»»åŠ¡çš„ä¸€ä¸ªæˆ–å¤šä¸ª Pod æˆåŠŸç»“æŸ<br></p><h4 id="volume" tabindex="-1"><a class="header-anchor" href="#volume" aria-hidden="true">#</a> Volume</h4><p>æ•°æ®å·ï¼Œå…±äº« Pod ä¸­å®¹å™¨ä½¿ç”¨çš„æ•°æ®ã€‚</p><h4 id="label" tabindex="-1"><a class="header-anchor" href="#label" aria-hidden="true">#</a> Label</h4><p>æ ‡ç­¾ç”¨äºåŒºåˆ†å¯¹è±¡ï¼ˆæ¯”å¦‚ Podã€Serviceï¼‰ï¼Œé”®/å€¼å¯¹å­˜åœ¨ï¼›æ¯ä¸ªå¯¹è±¡å¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾ï¼Œé€šè¿‡æ ‡ç­¾å…³è”å¯¹è±¡ã€‚<br> Kubernetes ä¸­ä»»æ„ API å¯¹è±¡éƒ½æ˜¯é€šè¿‡ Label è¿›è¡Œæ ‡è¯†ï¼ŒLabel çš„å®è´¨æ˜¯ä¸€ç³»åˆ—çš„ Key/Value é”®å€¼å¯¹ï¼Œå…¶ä¸­ key äº value ç”±ç”¨æˆ·è‡ªå·±æŒ‡å®šã€‚</p><h2 id="æœåŠ¡å‘ç°" tabindex="-1"><a class="header-anchor" href="#æœåŠ¡å‘ç°" aria-hidden="true">#</a> æœåŠ¡å‘ç°</h2><h4 id="service" tabindex="-1"><a class="header-anchor" href="#service" aria-hidden="true">#</a> service</h4><p>Service æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µã€‚å®ƒé€šè¿‡ä¸€ä¸ªè™šæ‹Ÿçš„ IP çš„å½¢å¼(VIPs)ï¼Œæ˜ å°„å‡ºæ¥æŒ‡å®šçš„ç«¯å£ï¼Œé€šè¿‡ä»£ç†å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚è½¬å‘åˆ°åç«¯ä¸€ç»„ Pods ä¸­çš„ä¸€å°ï¼ˆä¹Ÿå°±æ˜¯ endpointï¼‰<br><br> Service æä¾›äº†ç»Ÿä¸€çš„æœåŠ¡è®¿é—®å…¥å£ä»¥åŠæœåŠ¡ä»£ç†å’Œå‘ç°æœºåˆ¶ï¼Œå…³è”å¤šä¸ªç›¸åŒ Label çš„ Podï¼Œç”¨æˆ·ä¸éœ€è¦äº†è§£åå° Pod æ˜¯å¦‚ä½•è¿è¡Œã€‚<br><br> é¦–å…ˆéœ€è¦å¼„æ˜ç™½ Kubernetes çš„ä¸‰ç§ IP<br></p><ul><li>Node IPï¼šNode èŠ‚ç‚¹çš„ IP åœ°å€ï¼ŒèŠ‚ç‚¹çš„ç‰©ç†ç½‘å¡ IP åœ°å€<br></li><li>Pod IPï¼š Pod çš„ IP åœ°å€<br></li><li>Cluster IPï¼šService çš„ IP åœ°å€<br></li></ul><h4 id="iptables" tabindex="-1"><a class="header-anchor" href="#iptables" aria-hidden="true">#</a> IPTables</h4><p>ptables æ¨¡å¼ä¸º Services çš„é»˜è®¤ä»£ç†æ¨¡å¼ã€‚</p><h4 id="è´Ÿè½½å‡è¡¡çš„æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#è´Ÿè½½å‡è¡¡çš„æ–¹å¼" aria-hidden="true">#</a> è´Ÿè½½å‡è¡¡çš„æ–¹å¼</h4><p>åœ¨ Linux ä¸­ä½¿ç”¨ iptables å®Œæˆ tcp çš„è´Ÿè½½å‡è¡¡æœ‰ä¸¤ç§æ¨¡å¼ï¼šéšæœºã€è½®è¯¢</p><ul><li>éšæœºæ–¹å¼<br><br> ç³»ç»Ÿä¸­æä¾› 3 ä¸ª serversï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡é…ç½® iptables ä½¿æµé‡å‡è¡¡è®¿é—®è¿™ 3 å° serverã€‚<br></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># éšæœºï¼š(Random balancing)</span>
iptables <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.1.1 <span class="token parameter variable">--dport</span> <span class="token number">27017</span> <span class="token parameter variable">-m</span> statistic <span class="token parameter variable">--mode</span> random <span class="token parameter variable">--probability</span> <span class="token number">0.33</span>  <span class="token parameter variable">-j</span> DNAT --to-destination <span class="token number">10.0</span>.0.2:1234
iptables <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.1.1 <span class="token parameter variable">--dport</span> <span class="token number">27017</span> <span class="token parameter variable">-m</span> statistic <span class="token parameter variable">--mode</span> random <span class="token parameter variable">--probability</span> <span class="token number">0.5</span> <span class="token parameter variable">-j</span> DNAT --to-destination <span class="token number">10.0</span>.0.3:1234
iptables <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.1.1 <span class="token parameter variable">--dport</span> <span class="token number">27017</span>  <span class="token parameter variable">-j</span> DNAT --to-destination <span class="token number">10.0</span>.0.4:1234

<span class="token comment"># rulesè¯´æ˜ï¼š</span>
<span class="token comment"># ç¬¬ä¸€æ¡è§„åˆ™ä¸­ï¼ŒæŒ‡å®š--probability 0.33 ï¼Œåˆ™è¯´æ˜è¯¥è§„åˆ™æœ‰33%çš„æ¦‚ç‡ä¼šå‘½ä¸­ï¼Œ</span>
<span class="token comment"># ç¬¬äºŒæ¡è§„åˆ™ä¹Ÿæœ‰33%çš„æ¦‚ç‡å‘½ä¸­ï¼Œå› ä¸ºè§„åˆ™ä¸­æŒ‡å®š --probability 0.5ã€‚ åˆ™å‘½ä¸­çš„æ¦‚ç‡ä¸ºï¼š50% * ï¼ˆ1 - 33%ï¼‰=0.33</span>
<span class="token comment"># ç¬¬ä¸‰æ¡è§„åˆ™ä¸­ï¼Œæ²¡æœ‰æŒ‡å®š --probability å‚æ•°ï¼Œå› æ­¤æ„å‘³ç€å½“åŒ¹é…èµ°åˆ°ç¬¬ä¸‰æ¡è§„åˆ™æ—¶ï¼Œåˆ™ä¸€å®šå‘½ä¸­ï¼Œæ­¤æ—¶èµ°åˆ°ç¬¬ä¸‰æ¡è§„åˆ™çš„æ¦‚ç‡ä¸ºï¼š1 - 0.33 -0.33 â‰ˆ 0.33ã€‚</span>
<span class="token comment"># ç”±ä¸Šå¯è§ï¼Œä¸‰æ¡è§„åˆ™å‘½ä¸­çš„å‡ ç‡ä¸€æ ·çš„ã€‚æ­¤å¤–ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä¿®æ”¹ä¸‰æ¡è§„åˆ™çš„å‘½ä¸­ç‡ï¼Œå¯ä»¥é€šè¿‡ --probability å‚æ•°è°ƒæ•´ã€‚</span>
<span class="token comment"># æ³¨æ„ï¼šå› ä¸ºiptablesä¸­ï¼Œè§„åˆ™æ˜¯æŒ‰é¡ºåºåŒ¹é…çš„ï¼Œç”±ä¸Šè‡³ä¸‹ä¾æ¬¡åŒ¹é…ï¼Œå› æ­¤è®¾è®¡iptablesè§„åˆ™æ—¶ï¼Œè¦ä¸¥æ ¼å¯¹è§„åˆ™è¿›è¡Œæ’åºã€‚å› æ­¤ä¸Šè¿°ä¸‰æ¡è§„åˆ™çš„é¡ºåºä¹Ÿä¸å¯ä»¥è°ƒæ¢ï¼Œä¸ç„¶å°±æ— æ³•å®ç°LBå‡åˆ†äº†ã€‚</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è½®è¯¢æ–¹å¼<br><br> æœ‰ 3 ä¸ª serverï¼Œ3 ä¸ª server è½®è¯¢å¤„ç†æµé‡åŒ…ï¼Œåˆ™è§„åˆ™é…ç½®å¦‚ä¸‹ï¼š<br></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#everyï¼šæ¯nä¸ªåŒ…åŒ¹é…ä¸€æ¬¡è§„åˆ™</span>
<span class="token comment">#packetï¼šä»ç¬¬pä¸ªåŒ…å¼€å§‹</span>
iptables <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.1.1 <span class="token parameter variable">--dport</span> <span class="token number">27017</span> <span class="token parameter variable">-m</span> statistic <span class="token parameter variable">--mode</span> nth <span class="token parameter variable">--every</span> <span class="token number">3</span> <span class="token parameter variable">--packet</span> <span class="token number">0</span> <span class="token parameter variable">-j</span> DNAT --to-destination <span class="token number">10.0</span>.0.2:1234
iptables <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.1.1 <span class="token parameter variable">--dport</span> <span class="token number">27017</span> <span class="token parameter variable">-m</span> statistic <span class="token parameter variable">--mode</span> nth <span class="token parameter variable">--every</span> <span class="token number">2</span> <span class="token parameter variable">--packet</span> <span class="token number">0</span>  <span class="token parameter variable">-j</span> DNAT --to-destination <span class="token number">10.0</span>.0.3:1234
iptables <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.1.1 <span class="token parameter variable">--dport</span> <span class="token number">27017</span> <span class="token parameter variable">-j</span> DNAT --to-destination <span class="token number">10.0</span>.0.4:1234

<span class="token comment"># rulesè¯´æ˜ï¼š</span>
<span class="token comment"># åœ¨è§„åˆ™ä¸­ n(--every) å’Œ p(--packet) ä»£è¡¨ç€ï¼š ä»ç¬¬ p ä¸ªåŒ…å¼€å§‹ï¼Œæ¯ n ä¸ªåŒ…æ‰§è¡Œè¯¥è§„åˆ™ã€‚</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ipvs" tabindex="-1"><a class="header-anchor" href="#ipvs" aria-hidden="true">#</a> IPVS</h4><p>IPVSï¼ˆIP è™šæ‹ŸæœåŠ¡å™¨ï¼‰å®ç°ä¼ è¾“å±‚è´Ÿè½½å¹³è¡¡ï¼Œé€šå¸¸ç§°ä¸ºç¬¬ 4 å±‚ LAN äº¤æ¢ï¼Œæ˜¯ Linux å†…æ ¸çš„ä¸€éƒ¨åˆ†ã€‚<br><br> IPVS æ”¯æŒçš„è´Ÿè½½å‡è¡¡ç®—æ³•æœ‰è¿™ä¹ˆå‡ ç§ï¼š<br></p><ul><li>rr: è½®è¯¢</li><li>lc: æœ€å°è¿æ¥æ•°</li><li>dh: ç›®çš„åœ°å€ hash</li><li>sh: æºåœ°å€ hash</li><li>sed: æœ€çŸ­æœŸæœ›å»¶è¿Ÿ</li><li>nq: æ— é¡»é˜Ÿåˆ—ç­‰å¾…</li></ul><h2 id="ingress-7-å±‚-åº”ç”¨å±‚-è´Ÿè½½å‡è¡¡" tabindex="-1"><a class="header-anchor" href="#ingress-7-å±‚-åº”ç”¨å±‚-è´Ÿè½½å‡è¡¡" aria-hidden="true">#</a> Ingress (7 å±‚[åº”ç”¨å±‚]è´Ÿè½½å‡è¡¡)</h2><p>Ingress æ˜¯ kubernetes ä¸ºäº†å®ç°åœ¨åº”ç”¨å±‚è¿›è¡Œè½¬å‘ï¼Œå¯¹ nginx è¿›è¡Œäº‘åŸç”Ÿæ¨¡å¼çš„å°è£…ï¼ˆå¢å¼ºï¼‰ï¼Œä½¿å¾— Ingress å¯ä»¥å¯¹ service å®ç°è¯·æ±‚çš„è½¬å‘ï¼Œä¸”å®ç°åŠ¨æ€è½¬å‘è§„åˆ™çš„æ”¹å†™ï¼›<br><br> ingress è§„åˆ™æ˜¯å¾ˆçµæ´»çš„ï¼Œå¯ä»¥æ ¹æ®ä¸åŒåŸŸåã€ä¸åŒ path è½¬å‘è¯·æ±‚åˆ°ä¸åŒçš„ serviceï¼Œå¹¶ä¸”æ”¯æŒ https/httpã€‚<br></p><h4 id="ingress-åœ°å€" tabindex="-1"><a class="header-anchor" href="#ingress-åœ°å€" aria-hidden="true">#</a> Ingress åœ°å€</h4><p>Ingress-nginx gitHub åœ°å€ï¼šæœ€æ–°ç‰ˆæœ¬åœ°å€ï¼š<a href="https://github.com/kubernetes/ingress-nginx/tree/master/deploy" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/ingress-nginx/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><br><br> æŒ‡å®šç‰ˆæœ¬çš„ä¸‹è½½åœ°å€ï¼š <a href="https://github.com/kubernetes/ingress-nginx/tree/nginx-0.30.0/deploy" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/ingress-nginx/tree/nginx-0.30.0/deploy<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><br><br> Ingress-nginx å®˜æ–¹ç½‘ç«™åœ°å€ï¼š<a href="https://kubernetes.github.io/ingress-nginx/" target="_blank" rel="noopener noreferrer">https://kubernetes.github.io/ingress-nginx/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><br></p><h4 id="ingress-éƒ¨ç½²æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ingress-éƒ¨ç½²æ–‡ä»¶" aria-hidden="true">#</a> Ingress éƒ¨ç½²æ–‡ä»¶</h4><ol><li>namespace.yaml<br><br> åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„å‘½åç©ºé—´ ingress-nginx</li><li>configmap.yaml<br><br> ConfigMap æ˜¯å­˜å‚¨é€šç”¨çš„é…ç½®å˜é‡çš„ï¼Œç±»ä¼¼äºé…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨æˆ·å¯ä»¥å°†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç”¨äºä¸åŒæ¨¡å—çš„ç¯å¢ƒå˜é‡ç»Ÿä¸€åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ç®¡ç†ï¼›è€Œå®ƒä¸é…ç½®æ–‡ä»¶çš„åŒºåˆ«åœ¨äºå®ƒæ˜¯å­˜åœ¨é›†ç¾¤çš„â€œç¯å¢ƒâ€ä¸­çš„ï¼Œå¹¶ä¸”æ”¯æŒ K8S é›†ç¾¤ä¸­æ‰€æœ‰é€šç”¨çš„æ“ä½œè°ƒç”¨æ–¹å¼ã€‚<br><br> ä»æ•°æ®è§’åº¦æ¥çœ‹ï¼ŒConfigMap çš„ç±»å‹åªæ˜¯é”®å€¼ç»„ï¼Œç”¨äºå­˜å‚¨è¢« Pod æˆ–è€…å…¶ä»–èµ„æºå¯¹è±¡ï¼ˆå¦‚ RCï¼‰è®¿é—®çš„ä¿¡æ¯ã€‚è¿™ä¸ secret çš„è®¾è®¡ç†å¿µæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œä¸»è¦åŒºåˆ«åœ¨äº ConfigMap é€šå¸¸ä¸ç”¨äºå­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼Œè€Œåªå­˜å‚¨ç®€å•çš„æ–‡æœ¬ä¿¡æ¯ã€‚<br><br> ConfigMap å¯ä»¥ä¿å­˜ç¯å¢ƒå˜é‡çš„å±æ€§ï¼Œä¹Ÿå¯ä»¥ä¿å­˜é…ç½®æ–‡ä»¶ã€‚<br></li><li>rbac.yaml<br><br> è´Ÿè´£ Ingress çš„ RBAC æˆæƒçš„æ§åˆ¶ï¼Œå…¶åˆ›å»ºäº† Ingress ç”¨åˆ°çš„ ServiceAccountã€ClusterRoleã€Roleã€RoleBindingã€ClusterRoleBinding</li><li>with-rbac.yaml<br><br> æ˜¯ Ingress çš„æ ¸å¿ƒï¼Œç”¨äºåˆ›å»º ingress-controllerã€‚å‰é¢æåˆ°è¿‡ï¼Œingress-controller çš„ä½œç”¨æ˜¯å°†æ–°åŠ å…¥çš„ Ingress è¿›è¡Œè½¬åŒ–ä¸º Nginx çš„é…ç½®</li><li>mandatory.yaml<br><br> å»ºç«‹ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£ï¼›å¦‚æœå¤–ç•Œè®¿é—®çš„åŸŸåä¸å­˜åœ¨çš„è¯ï¼Œåˆ™é»˜è®¤è½¬å‘åˆ° default-http-backend è¿™ä¸ª Serviceï¼Œå…¶ä¼šç›´æ¥è¿”å› 404ï¼š<br><br> 220 è¡Œï¼Œä¿®æ”¹ image åœ°å€ï¼š<a href="http://registry.cn-hangzhou.aliyuncs.com/google_containers/nginx-ingress-controller:0.30.0" target="_blank" rel="noopener noreferrer">registry.cn-hangzhou.aliyuncs.com/google_containers/nginx-ingress-controller:0.30.0<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Service-NodePort.yaml<br></li></ol><h4 id="ingress-éƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#ingress-éƒ¨ç½²" aria-hidden="true">#</a> Ingress éƒ¨ç½²</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å°†ä¸Šè¿°éƒ¨ç½²æ–‡ä»¶å¤¹ä¸­éƒ¨ç½²ingress</span>
kubectl apply <span class="token parameter variable">-f</span> ./
<span class="token comment"># æŸ¥çœ‹ingress-nginxç»„ä»¶çŠ¶æ€</span>
kubectl get pod <span class="token parameter variable">-n</span> ingress-nginxã€€
kubectl get pod <span class="token parameter variable">-n</span> ingress-nginx --show-labels
<span class="token comment"># æŸ¥çœ‹Deploymentçš„çŠ¶æ€</span>
kubectl get Deployment <span class="token parameter variable">-n</span> ingress-nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://gitee.com/haijunit/blog-vuepress/edit/main/docs/61.å®¹å™¨æŠ€æœ¯/62.kuberneteså®æˆ˜/40.K8Sæ ¸å¿ƒç»„ä»¶.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><!----></div></footer><nav class="vp-page-nav"><a class="vp-link nav-link prev" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/30.MySQL%E4%B8%BB%E4%BB%8E.html"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->MySQLä¸»ä»</div></a><a class="vp-link nav-link next" href="/61.%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/62.kubernetes%E5%AE%9E%E6%88%98/50.K8S%E5%AE%9E%E6%88%98.html"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">K8Så®æˆ˜<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!----></div><!--]--><!--]--><!----><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-d6438571.js" defer></script>
  </body>
</html>